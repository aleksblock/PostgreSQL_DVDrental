# PostgreSQL_DVDrental

В данном репозитории приведены различные запросы к базе данных "DVD rental".
База данных “DVD rental” представляет бизнес-процессы магазина проката DVD.

<b>Основные таблицы базы данных “DVD проката”:</b>
<ul>
  <li>actor — хранит данные об актёрах, включая их имя и фамилию.</li>
  <li>film — хранит данные о фильмах, включая их название, год выпуска, время, рейтинг и т.д.</li>
  <li>film_actor — хранит отношения между фильмами и актёрами.</li>
  <li>category — хранит данные о жанрах фильмов.film_category -хранит отношения между фильмами и жанрами.</li>
  <li>inventory — хранит данные инвентаризации.</li>
  <li>rental — хранит данные об аренде.</li>
  <li>payment — хранит платежи клиента.</li>
  <li>staff — хранит данные персонала.</li>
  <li>customer — хранит данные покупателей.</li>
  <li>address — хранит адресные данные для сотрудников и клиентов.</li>
  <li>city — хранит названия городов.</li>
  <li>country — хранит названия стран.</li>  
</ul>

Описание БД тут: https://www.postgresqltutorial.com/postgresql-getting-started/postgresql-sample-database/

<b>Модель ER “DVD rental”:</b>

![DVDrental_ERmodel](https://user-images.githubusercontent.com/38960003/215278490-69543bcd-0759-4ce9-a19b-07be7f756af2.png)

<b>Cписок запросов:</b>
<ol>
  <li>С помощью SQL-запроса выведите названия ограничений первичных ключей.</li>
  <li>Выведите уникальные названия городов из таблицы городов, названия которых начинаются на “L” и заканчиваются на “a”, и названия не содержат пробелов.</li>
  <li>Получите из таблицы платежей за прокат фильмов информацию по платежам, которые выполнялись в промежуток с 17 июня 2005 года по 19 июня 2005 года включительно, 
      и стоимость которых превышает 1.00.</li>
  <li>Выведите информацию о 10-ти последних платежах за прокат фильмов.</li>
  <li>Выведите следующую информацию по покупателям: ...</li>
  <li>Выведите одним запросом только активных покупателей, имена которых KELLY или WILLIE. Все буквы в фамилии и имени из верхнего регистра должны быть переведены в нижний регистр</li>
  <li>Выведите одним запросом информацию о фильмах, у которых рейтинг "R" и стоимость аренды указана от 0.00 до 3.00 включительно, а также фильмы c рейтингом "PG-13" и стоимостью аренды больше или равной 4.00.</li>
  <li>Получите информацию о трёх фильмах с самым длинным описанием фильма.</li>
  <li>Выведите Email каждого покупателя, разделив значение Email на 2 отдельных колонки ...</li> 
  
  <li>Выведите для каждого покупателя его адрес проживания, город и страну проживания.</li>
  <li>С помощью SQL-запроса посчитайте для каждого магазина количество его покупателей, у которых количество покупателей больше 300-от</li>
  <li>Доработайте запрос 11,  добавив в него информацию о городе магазина, а также фамилию и имя продавца, который работает в этом магазине.</li>
  <li>Выведите ТОП-5 покупателей, которые взяли в аренду за всё время наибольшее количество фильмов</li>
  <li>Посчитайте для каждого покупателя 4 аналитических показателя: 1. количество фильмов, которые он взял в аренду, 2. общую стоимость платежей за аренду всех фильмов (значение округлите до целого числа), 3. минимальное значение платежа за аренду фильма, 4. максимальное значение платежа за аренду фильма</li>
  <li>Используя данные из таблицы городов составьте одним запросом всевозможные пары городов таким образом, чтобы в результате не было пар с одинаковыми названиями городов.</li>
  <li> Используя данные из таблицы rental о дате выдачи фильма в аренду (поле rental_date) и дате возврата фильма (поле return_date), вычислите для каждого покупателя среднее количество дней, за которые покупатель возвращает фильмы</li>
  <li>Посчитайте для каждого фильма сколько раз его брали в аренду и значение общей стоимости аренды фильма за всё время.</li>
  <li>Доработайте запрос 17 и выведите с помощью запроса фильмы, которые ни разу не брали в аренду.</li> 
  <li>Посчитайте количество продаж, выполненных каждым продавцом. Добавьте вычисляемую колонку "Премия". Если количество продаж превышает 7300, то значение в колонке будет "Да", иначе должно быть значение "Нет".</li> 
</ol>

<!--<b>Модель ER “DVD rental”</b>-->
<!--![DVDrental_ERmodel](https://user-images.githubusercontent.com/38960003/212486435-8204702a-1bb0-40dc-8fb6-9eed1fd45a4c.png)-->

